<div class="section-title primary-text">{{languageService.getText("ShiftDetail")}}</div>
<div class="mat-elevation-z5 rounded-div" fxLayout="row wrap" fxLayoutGap="10px">
    <div fxFlex="0 1 calc(33.3% - 10px)" fxLayout="row" class="text-block div-right-border">
        <div fxFlex="30" fxLayoutAlign="start center" class="accent-text">{{languageService.getText("FSQNameHeader")}}
        </div>
        <div fxFlex="10" fxLayoutAlign="center center" class="accent-text">{{languageService.getText("colonText")}}
        </div>
        <div fxFlex="60" fxLayoutAlign="start center" *ngIf="!!shift">
            <b>{{shift.fsq_name}}</b></div>
    </div>
    <div fxFlex="0 1 calc(33.3% - 10px)" fxLayout="row" class="text-block div-right-border">
        <div fxFlex="30" fxLayoutAlign="start center" class="accent-text">{{languageService.getText("FSQHubregionText")}}
        </div>
        <div fxFlex="10" fxLayoutAlign="center center" class="accent-text">{{languageService.getText("colonText")}}
        </div>
        <div fxFlex="60" fxLayoutAlign="start center" *ngIf="!!shift">
            <b>{{shift.region_name}}</b></div>
    </div>
    <div fxFlex="0 1 calc(33.3% - 10px)" fxLayout="row" class="text-block">
        <div fxFlex="30" fxLayoutAlign="start center" class="accent-text">{{languageService.getText("ShiftStartTimeText")}}</div>
        <div fxFlex="10" fxLayoutAlign="center center" class="accent-text">{{languageService.getText("colonText")}}
        </div>
        <div fxFlex="60" fxLayoutAlign="start center" *ngIf="!!shift">
        <b>{{shift.shift_start_datetime | date: 'medium'}}</b></div>
    </div>
    <div fxFlex="0 1 calc(33.3% - 10px)" fxLayout="row" class="text-block div-right-border">
        <div fxFlex="30" fxLayoutAlign="start center" class="accent-text">{{languageService.getText("ShiftEndTimeText")}}
        </div>
        <div fxFlex="10" fxLayoutAlign="center center" class="accent-text">{{languageService.getText("colonText")}}
        </div>
        <div fxFlex="60" fxLayoutAlign="start center" *ngIf="!!shift">
            <b>{{shift.shift_end_datetime | date: 'medium'}}</b></div>
    </div>
    <div fxFlex="0 1 calc(33.3% - 10px)" fxLayout="row" class="text-block div-right-border">
        <div fxFlex="30" fxLayoutAlign="start center" class="accent-text">{{languageService.getText("createdOnHeader")}}
            </div>
        <div fxFlex="10" fxLayoutAlign="center center" class="accent-text">{{languageService.getText("colonText")}}
        </div>
        <div fxFlex="60" fxLayoutAlign="start center" *ngIf="!!shift">
            <b>{{shift.created_on | date: 'medium'}}</b></div>
    </div>
    <div fxFlex="0 1 calc(33.3% - 10px)" fxLayout="row" class="text-block">
        <div fxFlex="30" fxLayoutAlign="start center" class="accent-text">{{languageService.getText("createdBytext")}}
        </div>
        <div fxFlex="10" fxLayoutAlign="center center" class="accent-text">{{languageService.getText("colonText")}}
        </div>
        <div fxFlex="60" fxLayoutAlign="start center" *ngIf="!!shift">
            <b>{{shift.created_by_name}}</b></div>
    </div>
    <div fxFlex="0 1 calc(33.3% - 10px)" fxLayout="row" class="text-block div-right-border">
        <div fxFlex="30" fxLayoutAlign="start center" class="accent-text">{{languageService.getText("statusHeaderText")}}
        </div>
        <div fxFlex="10" fxLayoutAlign="center center" class="accent-text">{{languageService.getText("colonText")}}
        </div>
        <div fxFlex="60" fxLayoutAlign="start center" *ngIf="!!shift">
            <b>{{shift.shift_status_name}}</b></div>
    </div>
</div>
<div class="section-title primary-text"  *ngIf="!!shift && shift.vehicle_assignment_status == 0">{{languageService.getText("bookVehicle")}}</div>
<div fxLayout="row" fxLayoutAlign="start center" class="mat-elevation-z5 rounded-div" *ngIf="!!shift && (shift.vehicle_assignment_status == 0 && ( shift.shift_status != 0 && shift.shift_status != 4))">
    <form [formGroup]="rentalPointForm"  [style.width.%]="100">
        <div fxFlex="45" fxLayoutGap="5px">
            <div fxFlex="25" fxLayoutAlign="end center">
                <mat-label>Region</mat-label>
            </div>
            <div fxFlex="75" fxLayoutAlign="center center">
                <mat-form-field [style.width.%]="80" appearance="outline">
                    <input matInput placeholder='Choose Region' formControlName="region"
                        [matAutocomplete]="activeRegion">
                    <mat-autocomplete #activeRegion="matAutocomplete" [displayWith]="displayRegion.bind(this)">
                        <mat-option *ngFor="let region of (fsqRegion$ | async)" [value]="region.region_id" (click)="getRentalPoint(region.region_id)">
                            {{region.region_name}}
                        </mat-option>
                    </mat-autocomplete>
                </mat-form-field>
              
            </div>
    </div>
           
    <div fxFlex="45" fxLayoutGap="5px">
        <div fxFlex="25" fxLayoutAlign="end center">
            <mat-label>{{languageService.getText("rentalPointNameText")}}</mat-label>
        </div>
        <div fxFlex="75" fxLayoutAlign="center center">
            <mat-form-field [style.width.%]="80" appearance="outline">
                <input matInput placeholder='Choose Rental point' [matAutocomplete]="rentalPoint"
                formControlName="rental_point_id">
                <mat-autocomplete #rentalPoint="matAutocomplete" [displayWith]="displayRentalPoint.bind(this)">
                    <span *ngFor="let region of ShiftRegion$  | async">
                        <mat-option  [value]="region.rentalpoint_id"  (click)="getVehicle(region.rentalpoint_id)" >
                            {{region.rentalpoint_name}} ({{region.rentalpoint_shortcode}})
                        </mat-option>
                    </span>
                </mat-autocomplete>
            </mat-form-field>
        </div>
    </div>

    <div fxFlex="45" fxLayoutGap="5px">
        <div fxFlex="25" fxLayoutAlign="end center">
            <mat-label>{{languageService.getText("vehicleNumber")}}</mat-label>
        </div>
        <div fxFlex="75" fxLayoutAlign="center center">
            <mat-form-field [style.width.%]="80" appearance="outline">
               
                <input matInput placeholder='Choose Vehicle' [matAutocomplete]="vehiclefill"
                formControlName="vehicle">
                <mat-autocomplete #vehiclefill="matAutocomplete" [displayWith]="displayvehicle.bind(this)">
                    <span *ngFor="let v of vehicle$  | async">
                        <mat-option  [value]="v.vehicle_id">
                            {{v.vehicle_idnumber}}
                        </mat-option>
                    </span>
                </mat-autocomplete>
            </mat-form-field>
        </div>
    </div>
    <div fxFlex="10" fxLayoutGap="5px">
        <div fxFlex="100" fxLayoutAlign="center center">
            <button mat-raised-button color="primary" type="button"
            (click)="book()" [disabled]="rentalPointForm.invalid" *ngIf="!!shift && shift.vehicle_assignment_status == 0">{{languageService.getText("bookVehicle")}}</button>
        </div>
    </div>
    </form>
</div>
<div class="section-title primary-text">{{languageService.getText("vehicleDetails")}}</div>
<div>
    <table mat-table matSort #vehicle="matSort" [dataSource]="dataSourceVehicle" class="mat-elevation-z5 rounded-table">
        <ng-container matColumnDef="vehicle_idnumber">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>
                {{languageService.getText("vehicleNumbertext")}}
            </th>
            <td mat-cell *matCellDef="let element">{{element.vehicle_idnumber}} </td>
        </ng-container>
        <ng-container matColumnDef="allocated_by_name">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>
                {{languageService.getText("allocatedby")}}
            </th>
            <td mat-cell *matCellDef="let element">{{element.allocated_by_name}}</td>
        </ng-container>
        <ng-container matColumnDef="allocation_time">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>
                {{languageService.getText("allocatedTime")}}
            </th>
            <td mat-cell *matCellDef="let element"> {{element.allocation_time | date : 'medium'}} </td>
        </ng-container>
        <ng-container matColumnDef="vehicle_current_status_name">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>
                {{languageService.getText("vehicleCurrentstateText")}}
            </th>
            <td mat-cell *matCellDef="let element"> {{element.vehicle_current_status_name}} </td>
        </ng-container>
        <ng-container matColumnDef="rentalpoint_name">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>
                {{languageService.getText("addRentalPointNameText")}}
            </th>
            <td mat-cell *matCellDef="let element"> {{element.rentalpoint_name}} </td>
        </ng-container>
        <ng-container matColumnDef="status_name">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>
                {{languageService.getText("DevicestatusnameText")}}
            </th>
            <td mat-cell *matCellDef="let element">{{element.status_name }} </td>
        </ng-container>
        <ng-container matColumnDef="Action">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>
                {{languageService.getText("ActionText")}}
            </th>
            <td mat-cell *matCellDef="let element">
                <button matTooltip="Return Vehicle" mat-icon-button color="accent" type="button" *ngIf="(element.status==1 && element.vehicle_current_status== 3) || element.status==2 && element.vehicle_current_status== 4"
                (click)="ReturnVehicle(element)"> <mat-icon>electrical_services</mat-icon> </button>
            </td>
        </ng-container>
        <tr mat-header-row *matHeaderRowDef="vehicleDisplayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: vehicleDisplayedColumns;"></tr>
    </table>
</div>
<div class="section-title primary-text">{{languageService.getText("jobDetail")}}</div>
<div>
    <table mat-table matSort #job="matSort" [dataSource]="dataSourceJob" class="mat-elevation-z5 rounded-table">
        <ng-container matColumnDef="work_item_ref_no">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>
                {{languageService.getText("workItemRefNo")}}
            </th>
            <td mat-cell *matCellDef="let element">{{element.work_item_ref_no}} </td>
        </ng-container>
        <ng-container matColumnDef="work_item_type_name">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>
                {{languageService.getText("TypeText")}}
            </th>
            <td mat-cell *matCellDef="let element">{{element.work_item_type_name}}</td>
        </ng-container>
        <ng-container matColumnDef="trip_uuid">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>
                {{languageService.getText("tripuuid")}}
            </th>
            <td mat-cell *matCellDef="let element"> {{element.trip_uuid}} </td>
        </ng-container>
        <ng-container matColumnDef="job_start_time">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>
                {{languageService.getText("tripStartTime")}}
            </th>
            <td mat-cell *matCellDef="let element">{{element.job_start_time | date : 'medium'}} </td>
        </ng-container>
        <ng-container matColumnDef="job_end_time">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>
                {{languageService.getText("tripEndTime")}}
            </th>
            <td mat-cell *matCellDef="let element">{{element.job_end_time | date : 'medium'}} </td>
        </ng-container>
        <ng-container matColumnDef="job_status_name">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>
                {{languageService.getText("StatusText")}}
            </th>
            <td mat-cell *matCellDef="let element">{{element.job_status_name }} </td>
        </ng-container>
        <ng-container matColumnDef="action">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>
                {{languageService.getText("ActionText")}}
            </th>
            <td mat-cell *matCellDef="let element">
                <button matTooltip="Start Job" mat-icon-button color="accent" type="button" *ngIf="element.job_status == 1" (click)="startJob(element)"> <mat-icon>work</mat-icon> </button>
             </td>
        </ng-container>
        <tr mat-header-row *matHeaderRowDef="jobDisplayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: jobDisplayedColumns;"></tr>
    </table>
</div>
<div class="form-container">
    <div fxLayout="row" [style.width.%]="100">
        <div fxFlex="100" fxLayoutAlign="end center">
            <div fxFlex="80" fxLayoutAlign="end center">
                <button mat-raised-button color="accent" type="button"  class="button-margin"
                    (click)="cancel()">{{languageService.getText("backButton")}}</button>
            </div>
        </div>
    </div>
</div>